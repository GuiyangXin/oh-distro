#ifndef __IMUCOMPENSATION_H__
#define __IMUCOMPENSATION_H__

#include <iostream>
#include <Eigen/Dense>
#include "InertialOdometry_Types.h"

namespace InertialOdometry
{
  class IMUCompensation {
    private:
    	
    	// TODO
    	// This should maybe be a CalibrationState struct from InertialOdometry_Types.h
       Eigen::Matrix<double, 3, 3> gyro_errors;
       Eigen::Matrix<double, 3, 3> accel_errors;
       Eigen::Vector3d gyro_biases;
       Eigen::Vector3d accel_biases;

    public:
       IMUCompensation();
       void UpdateGyroBiases(double biases[3]);
       void UpdateAccelBiases(double biases[3]);
       void UpdateGyroScaleFactor(double sf[3]);
       void UpdateAccelScaleFactor(double sf[3]);
       void SetGyroMisalignments(double MA[3]);
       void SetAccelMisalignments(double MA[3]);
       void Full_Compensation(IMU_dataframe &imu_pre);
       void Gyro_Compensation(IMU_dataframe &imu_pre);
       void Accel_Compensation(IMU_dataframe &imu_pre);
       //void testref(IMU_dataframe &imu);

       void cout_current_values();
  };

}

#endif

