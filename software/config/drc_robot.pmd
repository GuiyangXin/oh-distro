group "0.development" {
    cmd "robot_deputy" {
        exec = "bot-procman-deputy -n robot";
        host = "localhost";
    }
    cmd "extra_deputy" {
        exec = "bot-procman-deputy -n extra";
        host = "localhost";
    }
    cmd "base_deputy" {
        exec = "bot-procman-deputy -n base";
        host = "localhost";
    }
}
group "a.0.drivers" {
    cmd "sa-left" {
        exec = "ptgrey-gige -f 2 -q 50 -c CAMERACHEST_LEFT -s 12502221 -r 270";
        host = "extra";
    }
    cmd "sa-right" {
        exec = "ptgrey-gige -f 2 -q 50 -c CAMERACHEST_RIGHT -s 12502233 -r 90";
        host = "extra";
    }
    cmd "rearcam" {
        exec = "ipwebcam -f 2 -q 50 -c CAMERAREAR -u http://admin:admin1234@10.66.171.26/video2.mjpg -r 90";
        host = "extra";
    }
    cmd "multisense" {
        exec = "drc-multisense -o 2";
        host = "extra";
    }
    cmd "atlas-off" {
        exec = "drc-atlas -p off";
        host = "robot";
    }
    cmd "logger-robot" {
        exec = "drc-lcm-logger.sh";
        host = "robot";
    }
}


# must be individually launched as per hardware setup
group "a.0.hand_drivers" {
    cmd "sandia-right" {
        exec = "rosrun mit_helios_scripts launch_hand_driver.sh SANDIA R";
        host = "robot";
    }
    cmd "sandia-left" {
        exec = "rosrun mit_helios_scripts launch_hand_driver.sh SANDIA L";
        host = "robot";
    }
    cmd "irobot-right" {
        exec = "rosrun mit_helios_scripts launch_hand_driver.sh IROBOT R 49";
        host = "robot";
    }
    cmd "irobot-left" {
        exec = "rosrun mit_helios_scripts launch_hand_driver.sh IROBOT L 47";
        host = "robot";
    }   
    cmd "aa-ros2lcm-hands" {
        exec = "roslaunch translators hands_notsim.launch";
        host = "robot";
    }
}

group "a.1.core" {
    cmd "aa-sync" {
        exec = "drc-state-sync -b -e";
        host = "robot";
    }
    cmd "viewer" {
        exec = "drc-viewer";
        host = "robot";
    }
    cmd "pserver" {
        exec = "bot-param-server $DRC_BASE/software/config/drc_robot_02.cfg";
        host = "extra";
    }
    cmd "aff_server" {
        exec = "affordance_server  -r robot";
        host = "extra";
    }
    cmd "j2f" {
        exec = "drc-joints2frames -g -b";
        host = "extra";
    }
    cmd "maps-server" {
        exec = "maps-server";
        host = "extra";
    }
    cmd "lidar-passthrough" {
        exec = "drc-lidar-passthrough -c 0.1";
        host = "extra";
    }
    cmd "image-tx" {
        exec = "drc-image-transmit";
        host = "extra";
    }
    cmd "data-request-server" {
        exec = "data-request-server";
        host = "extra";
    }
    cmd "utime-publisher" {
        exec = "drc-utime-publisher -f 0";
        host = "extra";
    }
    cmd "drc-frequency" {
        exec = "drc-frequency";
        host = "extra";
    }
}

group "a.2.p_and_c" {
    cmd "SandiaGraspController" {
       exec = "matlab -nosplash -nodesktop -r \"addpath_control; cd([getenv('DRC_PATH'),'/control/matlab/controllers/grasping']); runGraspExecutionForSandiaHand;\"";
       host = "extra";
    } 
    cmd "IrobotGraspController" {
       exec = "matlab -nosplash -nodesktop -r \"addpath_control; cd([getenv('DRC_PATH'),'/control/matlab/controllers/grasping']); runGraspExecutionForIRobotHand;\"";
       host = "extra";
    }
    cmd "BotBDIStepTranslator" {
        exec = "drc-bdi-step-translator";
        host = "robot";
    }
    cmd "AtlasManipController" {
        exec = "matlab -nosplash -nodesktop -r \"addpath_control; runAtlasStateMachine;\"";
        host = "robot";
    }
}

group "a.3.models" {   
    cmd "model_LN_RN" {
        exec = "robot_model_publisher -u $DRC_BASE/software/models/mit_gazebo_models/mit_robot/model_LN_RN.urdf";
        host = "extra";
    }
    cmd "model_LN_RI" {
        exec = "robot_model_publisher -u $DRC_BASE/software/models/mit_gazebo_models/mit_robot/model_LN_RI.urdf";
        host = "extra";
    }
    cmd "model_LN_RS" {
        exec = "robot_model_publisher -u $DRC_BASE/software/models/mit_gazebo_models/mit_robot/model_LN_RS.urdf";
        host = "extra";
    }
    cmd "model_LS_RN" {
        exec = "robot_model_publisher -u $DRC_BASE/software/models/mit_gazebo_models/mit_robot/model_LS_RN.urdf";
        host = "extra";
    }
    cmd "model_LS_RI" {
        exec = "robot_model_publisher -u $DRC_BASE/software/models/mit_gazebo_models/mit_robot/model_LS_RI.urdf";
        host = "extra";
    }
    cmd "model_LS_RS" {
        exec = "robot_model_publisher -u $DRC_BASE/software/models/mit_gazebo_models/mit_robot/model_LS_RS.urdf";
        host = "extra";
    }
    cmd "model_LI_RN" {
        exec = "robot_model_publisher -u $DRC_BASE/software/models/mit_gazebo_models/mit_robot/model_LI_RN.urdf";
        host = "extra";
    }
    cmd "model_LI_RI" {
        exec = "robot_model_publisher -u $DRC_BASE/software/models/mit_gazebo_models/mit_robot/model_LI_RI.urdf";
        host = "extra";
    }
    cmd "model_LI_RS" {
        exec = "robot_model_publisher -u $DRC_BASE/software/models/mit_gazebo_models/mit_robot/model_LI_RS.urdf";
        host = "extra";
    }
}

group "b.1.core" {
    cmd "base_viewer" {
        exec = "drc-viewer  -r base -c drc_robot_02.cfg"; 
        host = "base";
    }
    cmd "aff_server" {
        exec = "affordance_server  -r base";
        host = "base";
    }
    cmd "j2f" {
        exec = "drc-joints2frames -r base -g";
        host = "base";
    }
    cmd "param_server" {
        exec = "bot-param-server $DRC_BASE/software/config/drc_robot_02.cfg -l 'udpm://239.255.76.68:7668?ttl=1'";
        host = "base";
    }
    cmd "est_rsp_base" {
        exec = "est_robot_state_publisher -g";
        host = "base";
    }
    cmd "image-rx" {
        exec = "drc-image-receive";
        host = "base";
    }
    cmd "lcm-logger-base" {
        exec = "lcm-logger  -f $DRC_BASE/data/latest_base_log.lcm";
        host = "base";
    }
}


group "b.2.p_and_c" {
    cmd "FootstepPlanner" {
       exec = "matlab -nosplash -nodesktop -r \"addpath_control; cd([getenv('DRC_PATH'),'/control/matlab/planners/footstep_planner']); runFootstepPlanner;\"";
       host = "base";
    }
    cmd "BaseBDIStepTranslator" {
        exec = "drc-bdi-step-translator -b";
        host = "base";
    }
    cmd "sticky_hands" {
       exec = "matlab -nosplash -nodesktop -r \"addpath_control; cd([getenv('DRC_PATH'),'/control/matlab/planners/sticky_hands']); runGraspSynthesisPoolServer(2);\"";
       host = "base";
    }
    cmd "ReachingPlanner" {
       exec = "matlab -nosplash -nodesktop -r \"addpath_control; cd([getenv('DRC_PATH'),'/control/matlab/planners/atlas_keyframe_planners']); runKeyFramePlannersLCMBase(2);\"";
       host = "base";
    }
}

group "b.3.models" {   
    cmd "base_model_LN_RN" {
        exec = "robot_model_publisher -u $DRC_BASE/software/models/mit_gazebo_models/mit_robot/model_LN_RN.urdf";
        host = "base";
    }
    cmd "base_model_LN_RI" {
        exec = "robot_model_publisher -u $DRC_BASE/software/models/mit_gazebo_models/mit_robot/model_LN_RI.urdf";
        host = "base";
    }
    cmd "base_model_LN_RS" {
        exec = "robot_model_publisher -u $DRC_BASE/software/models/mit_gazebo_models/mit_robot/model_LN_RS.urdf";
        host = "base";
    }
    cmd "base_model_LS_RN" {
        exec = "robot_model_publisher -u $DRC_BASE/software/models/mit_gazebo_models/mit_robot/model_LS_RN.urdf";
        host = "base";
    }
    cmd "base_model_LS_RI" {
        exec = "robot_model_publisher -u $DRC_BASE/software/models/mit_gazebo_models/mit_robot/model_LS_RI.urdf";
        host = "base";
    }
    cmd "base_model_LS_RS" {
        exec = "robot_model_publisher -u $DRC_BASE/software/models/mit_gazebo_models/mit_robot/model_LS_RS.urdf";
        host = "base";
    }
    cmd "base_model_LI_RN" {
        exec = "robot_model_publisher -u $DRC_BASE/software/models/mit_gazebo_models/mit_robot/model_LI_RN.urdf";
        host = "base";
    }
    cmd "base_model_LI_RI" {
        exec = "robot_model_publisher -u $DRC_BASE/software/models/mit_gazebo_models/mit_robot/model_LI_RI.urdf";
        host = "base";
    }
    cmd "base_model_LI_RS" {
        exec = "robot_model_publisher -u $DRC_BASE/software/models/mit_gazebo_models/mit_robot/model_LI_RS.urdf";
        host = "base";
    }
}

group "m.control" {
    cmd "NeckPitchCommand" {
        exec = "matlab -nosplash -nodesktop -r \"addpath_control; atlasNeckControl(0.75);\"";
        host = "base";
    }
    cmd "atlas-high" {
        exec = "drc-atlas -p high";
        host = "robot";
    }
}

group "m.state_est" {
    cmd "StateEstimate" {
        exec = "state-estimate -x -M";
        host = "robot";
    }
}

group "m.trajectory_simulator" {
    cmd "ReferenceINS_MATLAB" {
        exec = "matlab -nosplash -nodesktop -r \"setup_datafusion; receiveimu;\"";
        host = "extra";
    }
    cmd "MotionSimulator_MATLAB" {
        exec = "matlab -nosplash -nodesktop -r \"setup_datafusion; simulateStateEstimateProcess; exit\"";
        host = "extra";
    }
}

group "m.perception" {
    cmd "ms-reconfig" {
        exec = "rosrun dynamic_reconfigure reconfigure_gui";
        host = "extra";
    }
    cmd "vicon" {
        exec = "vicon-client 192.168.10.1";
        host = "extra";
    }
    cmd "ipwebcam" {
        exec = "ipwebcam -f 10 -q 90 -c IPWEBCAM -u http://admin:@192.168.0.20/video2.mjpg";
        host = "robot";
    }
    cmd "webcam" {
        exec = "camview -c webcam.camview";
        host = "robot";
    }

    cmd "multisense-ros" {
        exec = "roslaunch multisense_bringup multisense.launch";
        host = "extra";
    }
    cmd "ms-subscribe" {
        exec = "rosrun multisense_command multisense_subscribe -d";
        host = "extra";
    }
    cmd "ms-command" {
        exec = "rosrun multisense_command multisense_command";
        host = "extra";
    }

}

group "m.hands" {
    cmd "sandia_hand_eigen_grasps" {
        exec = "sandia-simple-grasp";
        host = "base";
    }
    cmd "sandia_keyboard" {
        exec = "sandia-simple-grasp-keyboard";
        host = "base";
    }
    cmd "irobot_hand_eigen_grasps" {
        exec = "rosrun handle_launch power_grasp_keyboard_teleop.py";
        host = "base";
    }
}

group "m.simple_grasping" {
    cmd "affordance_to_grasp_plan" {
        exec = "affordance_to_grasp_plan";
        host = "base";
    }
    cmd "fake-grasp-pool" {
        exec = "drc-fake-grasp-pool";
        host = "base";
    }
}


#################################################################

script "prep_core" { 
    start group "0.development";
    start cmd "logger-robot";
    start group "a.1.core";
    start group "a.2.p_and_c";
    start group "b.2.p_and_c";
    start cmd "atlas-off";
    start cmd "multisense";
    start cmd "sa-right";
    start cmd "sa-left";
}

script "prep_LN_RN" { 
    start cmd "model_LN_RN";
    start cmd "base_model_LN_RN";
    run_script "prep_core";
}

script "prep_LN_RS" {
    start cmd "model_LN_RS";
    start cmd "base_model_LN_RS";
    run_script "prep_core";
    start cmd "SandiaGraspController";
    start cmd "aa-ros2lcm-hands";
    start cmd "sandia-right";
}

script "prep_LN_RI" {
    start cmd "model_LN_RI";
    start cmd "base_model_LN_RI";
    run_script "prep_core";
    start cmd "IrobotGraspController";
    start cmd "aa-ros2lcm-hands";
    start cmd "irobot-right";
}

script "prep_LS_RN" {
    start cmd "model_LS_RN";
    start cmd "base_model_LS_RN";
    run_script "prep_core";
    start cmd "SandiaGraspController";
    start cmd "aa-ros2lcm-hands";
    start cmd "sandia-left";
}

script "prep_LS_RS" {
    start cmd "model_LS_RS";
    start cmd "base_model_LS_RS";
    run_script "prep_core";
    start cmd "SandiaGraspController";
    start cmd "aa-ros2lcm-hands";
    start cmd "sandia-left";
    start cmd "sandia-right";
}

script "prep_LS_RI" {
    start cmd "model_LS_RI";
    start cmd "base_model_LS_RI";
    run_script "prep_core";
    start cmd "SandiaGraspController";
    start cmd "IrobotGraspController";
    start cmd "aa-ros2lcm-hands";
    start cmd "sandia-left";
    start cmd "irobot-right";
}

script "prep_LI_RN" {
    start cmd "model_LI_RN";
    start cmd "base_model_LI_RN";
    run_script "prep_core";
    start cmd "IrobotGraspController";
    start cmd "aa-ros2lcm-hands";
    start cmd "irobot-left";
}

script "prep_LI_RS" {
    start cmd "model_LI_RS";
    start cmd "base_model_LI_RS";
    run_script "prep_core";
    start cmd "SandiaGraspController";
    start cmd "IrobotGraspController";
    start cmd "aa-ros2lcm-hands";
    start cmd "irobot-left";
    start cmd "sandia-right";
}

script "prep_LI_RI" {
    start cmd "model_LI_RI";
    start cmd "base_model_LI_RI";
    run_script "prep_core";
    start cmd "IrobotGraspController";
    start cmd "aa-ros2lcm-hands";
    start cmd "irobot-left";
    start cmd "irobot-right";
}



script "simple_grasp" {
    stop cmd "sticky_hands";
    stop cmd "SandiaGraspController";
    start group "m.simple_grasping";
}


script "robot_start" { 
    stop cmd "atlas-off";
    wait ms 2000;
    start cmd "atlas-high";
}
