import "goby/acomms/protobuf/dccl_option_extensions.proto";
import "goby/acomms/protobuf/arithmetic_extensions.proto";


package drc;

message MinimalRobotState
{
  option (dccl.msg).max_bytes = 1500;
  option (dccl.msg).id = 0xD4C0004;

  required double utime = 1 [(dccl.field) = { min: 0 max: 1450000000e6 precision: -3 }];
  required Position3D pose = 2;
  repeated float joint_position = 3 [(dccl.field) = { min: -4 max: 4 precision: 3 max_repeat: 70 codec: "presence_bit" } ];
  repeated int32 joint_id = 4 [(dccl.field) = { min: 0 max: 109 max_repeat: 110 codec: "presence_bit" } ];

  // jp: precision was 2 -> 90bytes | 3 -> 110bytes


  // 2*joint effort, then divide by 2 to get precision of 0.5
  repeated float twice_joint_effort = 5 [(dccl.field) = { min: -354 max: 354 max_repeat: 30 precision: 0 codec: "presence_bit" } ];

  optional float l_foot_force_z = 10 [(dccl.field) = { min: -500  max: 2000 precision: 1 codec: "presence_bit" } ];
  optional float l_foot_torque_x = 11 [(dccl.field) = { min: -500 max: 500 precision: 1 codec: "presence_bit" } ];
  optional float l_foot_torque_y = 12 [(dccl.field) = { min: -500 max: 500 precision: 1 codec: "presence_bit" } ];

  optional float r_foot_force_z = 13 [(dccl.field) = { min: -500 max: 2000 precision: 1 codec: "presence_bit" } ];
  optional float r_foot_torque_x = 14 [(dccl.field) = { min: -500 max: 500 precision: 1 codec: "presence_bit" } ];
  optional float r_foot_torque_y = 15 [(dccl.field) = { min: -500 max: 500 precision: 1 codec: "presence_bit" } ];

  repeated float l_hand_force = 20 [(dccl.field) = { min: -600 max: 600 precision: 1 max_repeat: 3 codec: "presence_bit" } ];
  repeated float l_hand_torque = 21 [(dccl.field) = { min: -250 max: 250 precision: 1 max_repeat: 3 codec: "presence_bit" } ];
  repeated float r_hand_force = 22 [(dccl.field) = { min: -600 max: 600 precision: 1 max_repeat: 3 codec: "presence_bit" } ];
  repeated float r_hand_torque = 23 [(dccl.field) = { min: -250 max: 250 precision: 1 max_repeat: 3 codec: "presence_bit"} ];  

}


message Position3D
{
  required TranslationVector translation = 1;
  optional RotationQuaternion rotation = 2;

  // for footstep plan only
  optional RotationRPY rpy_rotation = 3;
}


message TranslationVector
{
  required double x = 1 [(dccl.field) = { min: -1000 max: 1000 precision: 3}];
  required double y = 2 [(dccl.field) = { min: -1000 max: 1000 precision: 3}];
  optional double z = 3 [(dccl.field) = { min: -100 max: 100 precision: 3 codec: "presence_bit"}];
}

message RotationQuaternion
{
  optional double x = 1 [(dccl.field) = {min: -1 max: 1 precision: 6 codec: "presence_bit" }];
  optional double y = 2 [(dccl.field) = {min: -1 max: 1 precision: 6 codec: "presence_bit" }];
  optional double z = 3 [(dccl.field) = {min: -1 max: 1 precision: 6 codec: "presence_bit" }];
  optional double w = 4 [(dccl.field) = {min: -1 max: 1 precision: 6 codec: "presence_bit" }];
}


message RotationRPY
{
  // 80 degrees, +/- one degree 
  optional double roll = 1 [(dccl.field) = {min: -1.397 max: 1.397 precision: 3 codec: "presence_bit" }];
  optional double pitch = 2 [(dccl.field) = {min: -1.397 max: 1.397 precision: 3 codec: "presence_bit" }];

  // 360 degrees, +/- one degree
  optional double yaw = 3 [(dccl.field) = {min: -3.142 max: 3.142 precision: 3 codec: "presence_bit" }];
}


message MinimalRobotStateDiff
{
  repeated double utime_diff = 1 [(dccl.field) = { min: 0 max: 600e6 precision: -3 max_repeat: 100 codec: "presence_bit" }];
  required Position3DDiff pos_diff = 2;
 
  repeated float joint_pos_diff_back_bkz = 3 [(dccl.field) = { max_repeat: 100 min: -6.284 max: 6.284 precision: 3 codec: "presence_bit"} ];
  repeated float joint_pos_diff_back_bky = 4 [(dccl.field) = { max_repeat: 100 min: -6.284 max: 6.284 precision: 3 codec: "presence_bit"} ];
  repeated float joint_pos_diff_back_bkx = 5 [(dccl.field) = { max_repeat: 100 min: -6.284 max: 6.284 precision: 3 codec: "presence_bit"} ];
  repeated float joint_pos_diff_neck_ay = 6 [(dccl.field) = { max_repeat: 100 min: -6.284 max: 6.284 precision: 3 codec: "presence_bit"} ];
  repeated float joint_pos_diff_l_leg_hpz = 7 [(dccl.field) = { max_repeat: 100 min: -6.284 max: 6.284 precision: 3 codec: "presence_bit"} ];
  repeated float joint_pos_diff_l_leg_hpx = 8 [(dccl.field) = { max_repeat: 100 min: -6.284 max: 6.284 precision: 3 codec: "presence_bit"} ];
  repeated float joint_pos_diff_l_leg_hpy = 9 [(dccl.field) = { max_repeat: 100 min: -6.284 max: 6.284 precision: 3 codec: "presence_bit"} ];
  repeated float joint_pos_diff_l_leg_kny = 10 [(dccl.field) = { max_repeat: 100 min: -6.284 max: 6.284 precision: 3 codec: "presence_bit"} ];
  repeated float joint_pos_diff_l_leg_aky = 11 [(dccl.field) = { max_repeat: 100 min: -6.284 max: 6.284 precision: 3 codec: "presence_bit"} ];
  repeated float joint_pos_diff_l_leg_akx = 12 [(dccl.field) = { max_repeat: 100 min: -6.284 max: 6.284 precision: 3 codec: "presence_bit"} ];
  repeated float joint_pos_diff_r_leg_hpz = 13 [(dccl.field) = { max_repeat: 100 min: -6.284 max: 6.284 precision: 3 codec: "presence_bit"} ];
  repeated float joint_pos_diff_r_leg_hpx = 14 [(dccl.field) = { max_repeat: 100 min: -6.284 max: 6.284 precision: 3 codec: "presence_bit"} ];
  repeated float joint_pos_diff_r_leg_hpy = 15 [(dccl.field) = { max_repeat: 100 min: -6.284 max: 6.284 precision: 3 codec: "presence_bit"} ];
  repeated float joint_pos_diff_r_leg_kny = 16 [(dccl.field) = { max_repeat: 100 min: -6.284 max: 6.284 precision: 3 codec: "presence_bit"} ];
  repeated float joint_pos_diff_r_leg_aky = 17 [(dccl.field) = { max_repeat: 100 min: -6.284 max: 6.284 precision: 3 codec: "presence_bit"} ];
  repeated float joint_pos_diff_r_leg_akx = 18 [(dccl.field) = { max_repeat: 100 min: -6.284 max: 6.284 precision: 3 codec: "presence_bit"} ];
  repeated float joint_pos_diff_l_arm_usy = 19 [(dccl.field) = { max_repeat: 100 min: -6.284 max: 6.284 precision: 3 codec: "presence_bit"} ];
  repeated float joint_pos_diff_l_arm_shx = 20 [(dccl.field) = { max_repeat: 100 min: -6.284 max: 6.284 precision: 3 codec: "presence_bit"} ];
  repeated float joint_pos_diff_l_arm_ely = 21 [(dccl.field) = { max_repeat: 100 min: -6.284 max: 6.284 precision: 3 codec: "presence_bit"} ];
  repeated float joint_pos_diff_l_arm_elx = 22 [(dccl.field) = { max_repeat: 100 min: -6.284 max: 6.284 precision: 3 codec: "presence_bit"} ];
  repeated float joint_pos_diff_l_arm_uwy = 23 [(dccl.field) = { max_repeat: 100 min: -6.284 max: 6.284 precision: 3 codec: "presence_bit"} ];
  repeated float joint_pos_diff_l_arm_mwx = 24 [(dccl.field) = { max_repeat: 100 min: -6.284 max: 6.284 precision: 3 codec: "presence_bit"} ];
  repeated float joint_pos_diff_r_arm_usy = 25 [(dccl.field) = { max_repeat: 100 min: -6.284 max: 6.284 precision: 3 codec: "presence_bit"} ];
  repeated float joint_pos_diff_r_arm_shx = 26 [(dccl.field) = { max_repeat: 100 min: -6.284 max: 6.284 precision: 3 codec: "presence_bit"} ];
  repeated float joint_pos_diff_r_arm_ely = 27 [(dccl.field) = { max_repeat: 100 min: -6.284 max: 6.284 precision: 3 codec: "presence_bit"} ];
  repeated float joint_pos_diff_r_arm_elx = 28 [(dccl.field) = { max_repeat: 100 min: -6.284 max: 6.284 precision: 3 codec: "presence_bit"} ];
  repeated float joint_pos_diff_r_arm_uwy = 29 [(dccl.field) = { max_repeat: 100 min: -6.284 max: 6.284 precision: 3 codec: "presence_bit"} ];
  repeated float joint_pos_diff_r_arm_mwx = 30 [(dccl.field) = { max_repeat: 100 min: -6.284 max: 6.284 precision: 3 codec: "presence_bit"} ];


  // all must have the same precision
  // repeated float joint_pos_diff_back_bkz = 3 [(dccl.field) = { max_repeat: 100 codec: "_arithmetic" [arithmetic] { model: "joint_pos_0" } }  ];
  // repeated float joint_pos_diff_back_bky = 4 [(dccl.field) = { max_repeat: 100 codec: "_arithmetic" [arithmetic] { model: "joint_pos_1" } } ];
  // repeated float joint_pos_diff_back_bkx = 5 [(dccl.field) = { max_repeat: 100 codec: "_arithmetic" [arithmetic] { model: "joint_pos_2" } } ];
  // repeated float joint_pos_diff_neck_ay = 6 [(dccl.field) = { max_repeat: 100 codec: "_arithmetic" [arithmetic] { model: "joint_pos_3" } } ];
  // repeated float joint_pos_diff_l_leg_hpz = 7 [(dccl.field) = { max_repeat: 100 codec: "_arithmetic" [arithmetic] { model: "joint_pos_4" } } ];
  // repeated float joint_pos_diff_l_leg_hpx = 8 [(dccl.field) = { max_repeat: 100 codec: "_arithmetic" [arithmetic] { model: "joint_pos_5" } } ];
  // repeated float joint_pos_diff_l_leg_hpy = 9 [(dccl.field) = { max_repeat: 100 codec: "_arithmetic" [arithmetic] { model: "joint_pos_6" } } ];
  // repeated float joint_pos_diff_l_leg_kny = 10 [(dccl.field) = { max_repeat: 100 codec: "_arithmetic" [arithmetic] { model: "joint_pos_7" } } ];
  // repeated float joint_pos_diff_l_leg_aky = 11 [(dccl.field) = { max_repeat: 100 codec: "_arithmetic" [arithmetic] { model: "joint_pos_8" } } ];
  // repeated float joint_pos_diff_l_leg_akx = 12 [(dccl.field) = { max_repeat: 100 codec: "_arithmetic" [arithmetic] { model: "joint_pos_9" } } ];
  // repeated float joint_pos_diff_r_leg_hpz = 13 [(dccl.field) = { max_repeat: 100 codec: "_arithmetic" [arithmetic] { model: "joint_pos_10" } } ];
  // repeated float joint_pos_diff_r_leg_hpx = 14 [(dccl.field) = { max_repeat: 100 codec: "_arithmetic" [arithmetic] { model: "joint_pos_11" } } ];
  // repeated float joint_pos_diff_r_leg_hpy = 15 [(dccl.field) = { max_repeat: 100 codec: "_arithmetic" [arithmetic] { model: "joint_pos_12" } } ];
  // repeated float joint_pos_diff_r_leg_kny = 16 [(dccl.field) = { max_repeat: 100 codec: "_arithmetic" [arithmetic] { model: "joint_pos_13" } } ];
  // repeated float joint_pos_diff_r_leg_aky = 17 [(dccl.field) = { max_repeat: 100 codec: "_arithmetic" [arithmetic] { model: "joint_pos_14" } } ];
  // repeated float joint_pos_diff_r_leg_akx = 18 [(dccl.field) = { max_repeat: 100 codec: "_arithmetic" [arithmetic] { model: "joint_pos_15" } } ];
  // repeated float joint_pos_diff_l_arm_usy = 19 [(dccl.field) = { max_repeat: 100 codec: "_arithmetic" [arithmetic] { model: "joint_pos_16" } } ];
  // repeated float joint_pos_diff_l_arm_shx = 20 [(dccl.field) = { max_repeat: 100 codec: "_arithmetic" [arithmetic] { model: "joint_pos_17" } } ];
  // repeated float joint_pos_diff_l_arm_ely = 21 [(dccl.field) = { max_repeat: 100 codec: "_arithmetic" [arithmetic] { model: "joint_pos_18" } } ];
  // repeated float joint_pos_diff_l_arm_elx = 22 [(dccl.field) = { max_repeat: 100 codec: "_arithmetic" [arithmetic] { model: "joint_pos_19" } } ];
  // repeated float joint_pos_diff_l_arm_uwy = 23 [(dccl.field) = { max_repeat: 100 codec: "_arithmetic" [arithmetic] { model: "joint_pos_20" } } ];
  // repeated float joint_pos_diff_l_arm_mwx = 24 [(dccl.field) = { max_repeat: 100 codec: "_arithmetic" [arithmetic] { model: "joint_pos_21" } } ];
  // repeated float joint_pos_diff_r_arm_usy = 25 [(dccl.field) = { max_repeat: 100 codec: "_arithmetic" [arithmetic] { model: "joint_pos_22" } } ];
  // repeated float joint_pos_diff_r_arm_shx = 26 [(dccl.field) = { max_repeat: 100 codec: "_arithmetic" [arithmetic] { model: "joint_pos_23" } } ];
  // repeated float joint_pos_diff_r_arm_ely = 27 [(dccl.field) = { max_repeat: 100 codec: "_arithmetic" [arithmetic] { model: "joint_pos_24" } } ];
  // repeated float joint_pos_diff_r_arm_elx = 28 [(dccl.field) = { max_repeat: 100 codec: "_arithmetic" [arithmetic] { model: "joint_pos_25" } } ];
  // repeated float joint_pos_diff_r_arm_uwy = 29 [(dccl.field) = { max_repeat: 100 codec: "_arithmetic" [arithmetic] { model: "joint_pos_26" } } ];
  // repeated float joint_pos_diff_r_arm_mwx = 30 [(dccl.field) = { max_repeat: 100 codec: "_arithmetic" [arithmetic] { model: "joint_pos_27" } } ];

  
  // repeated JointPositionDiff joint_pos_diff = 3 [(dccl.field) = { max_repeat: 100 }];
  
  // message JointPositionDiff
  // {
  //   repeated float jp_diff_val= 3 [(dccl.field) = { min: -3.142 max: 3.142 precision: 3 max_repeat: 53 codec: "presence_bit" } ];
  // }
  
}

message Position3DDiff
{
  required TranslationVectorDiff translation_diff = 1;
  optional RotationQuaternionDiff rotation_diff = 2;

  // for footstep plan only
  optional RotationRPYDiff rpy_rotation_diff = 3;
}

message TranslationVectorDiff
{
  repeated double dx = 1 [(dccl.field) = { min: -1.6 max: 1.6 precision: 3 max_repeat: 100 codec: "presence_bit"}];
  repeated double dy = 2 [(dccl.field) = { min: -1.6 max: 1.6 precision: 3 max_repeat: 100 codec: "presence_bit"}];
  repeated double dz = 3 [(dccl.field) = { min: -1.6 max: 1.6 precision: 3 max_repeat: 100 codec: "presence_bit"}];
}

message RotationQuaternionDiff
{
  repeated double dx = 1 [(dccl.field) = {min: -2 max: 2 precision: 6 max_repeat: 100 codec: "presence_bit"}];
  repeated double dy = 2 [(dccl.field) = {min: -2 max: 2 precision: 6 max_repeat: 100 codec: "presence_bit"}];
  repeated double dz = 3 [(dccl.field) = {min: -2 max: 2 precision: 6 max_repeat: 100 codec: "presence_bit"}];
  repeated double dw = 4 [(dccl.field) = {min: -2 max: 2 precision: 6 max_repeat: 100 codec: "presence_bit"}];
}

message RotationRPYDiff
{
   repeated double droll = 1 [(dccl.field) = {min: -2.794 max: 2.794 precision: 3 max_repeat: 100 codec: "presence_bit" }];
   repeated double dpitch = 2 [(dccl.field) = {min: -2.794 max: 2.794 precision: 3 max_repeat: 100 codec: "presence_bit" }];

  //repeated double droll = 1 [(dccl.field) = { precision: 3 max_repeat: 100  codec: "_arithmetic" [arithmetic] { model: "rollpitch" } }];
  //repeated double dpitch = 2 [(dccl.field) = { precision: 3 max_repeat: 100  codec: "_arithmetic" [arithmetic] { model: "rollpitch" } }];
  
  repeated double dyaw = 3 [(dccl.field) = {min: -6.283 max: 6.283 precision: 3 max_repeat: 100 codec: "presence_bit" }];
}
