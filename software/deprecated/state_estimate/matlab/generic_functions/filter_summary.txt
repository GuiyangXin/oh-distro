

% time update
priori.M = kf_P_TU(sys_d.a,covariances.Qd,previous.P);
%priori.K = kf_K(priori.M,sys_d.c,covariances.Rd);
priori.x = sys_d.a*previous.x + sys_d.b*u;

% measurement update
priori.K = kf_K(priori.M,sys_d.c,covariances.Rd);
posterior.innov = kf_innov(y,sys_d.c,priori.x);
posterior.x = priori.x + priori.K * posterior.innov;
posterior.P = kf_P_MU(priori.K,sys_d.c,priori.M);


