function make_gantt(h,data_path,task)
%close all; clear all
d= load([data_path '/' task '/task_anatomy.txt'])


colors = [ 251/255.0, 154/255.0, 153/255.0;...
  178/255.0, 223/255.0, 138/255.0;...
  166/255.0, 206/255.0, 227/255.0;...
  51/255.0, 160/255.0, 44/255.0;...    
    31/255.0, 120/255.0, 180/255.0;...
    227/255.0, 26/255.0, 28/255.0;...
    253/255.0, 191/255.0, 111/255.0;...
    106/255.0, 61/255.0, 154/255.0;...
    255/255.0, 127/255.0, 0/255.0;...
    202/255.0, 178/255.0, 214/255.0;...
     51/255.0, 160/255.0, 44/255.0;...
    166/255.0, 206/255.0, 227/255.0;...
    178/255.0, 223/255.0, 138/255.0;...
    31/255.0, 120/255.0, 180/255.0;...
    251/255.0, 154/255.0, 153/255.0;...
    227/255.0, 26/255.0, 28/255.0;...
    253/255.0, 191/255.0, 111/255.0;...
    106/255.0, 61/255.0, 154/255.0;...
    255/255.0, 127/255.0, 0/255.0;...
    202/255.0, 178/255.0, 214/255.0;...
     51/255.0, 160/255.0, 44/255.0;...
    166/255.0, 206/255.0, 227/255.0;...
    178/255.0, 223/255.0, 138/255.0;...
    31/255.0, 120/255.0, 180/255.0;...
    251/255.0, 154/255.0, 153/255.0;...
    227/255.0, 26/255.0, 28/255.0;...
    253/255.0, 191/255.0, 111/255.0;...
    106/255.0, 61/255.0, 154/255.0;...
    255/255.0, 127/255.0, 0/255.0;...
    202/255.0, 178/255.0, 214/255.0;...
    1.0, 0.0, 0.0;...
    0.0, 1.0, 0.0;...
    0.0, 0.0, 1.0;...
    1.0, 1.0, 0.0;...
    1.0, 0.0, 1.0;...
    0.0, 1.0, 1.0;...
    0.5, 1.0, 0.0;...
    1.0, 0.5, 0.0;...
    0.5, 0.0, 1.0;...
    1.0, 0.0, 0.5;...
    0.0, 0.5, 1.0;...
    0.0, 1.0, 0.5;...
    1.0, 0.5, 0.5;...
    0.5, 1.0, 0.5;...
    0.5, 0.5, 1.0;...
    0.5, 0.5, 1.0;...
    0.5, 1.0, 0.5;...
    0.5, 0.5, 1.0]

labels = ['Settle','Step','Fit','Plan','Reach','Teleop', ...
  'Scripted','Offscript', 'Drill', 'Grasp' , 'System'];
mapping = [1, 0.5; ... % settle
           5, 0; ... % stepping
           9, 5.; ... % fit
           10, 5.5; ... % 
           11, 2.;... % reach
           12, 3.;... % teleop
           13, 1.5;...  %scripted
           14, 100;...
           15, 3.5;...  %drill
           16, 2.5;...  %grasp
           17, 6.]    % system

%set(gcf, 'Position', [3000, 100, 640, 350]);


hold on
for i=1:size(d,1)
  row = mapping(find(mapping(:,1) == d(i,3)),2);
  wrow = row + [0 0.5] ;
  dims = [ d(i,1) wrow(1) d(i,2)-d(i,1) wrow(2)-wrow(1)]
  
  rectangle('Position', dims, ...
    'FaceColor', colors(d(i,3),:) )
    %'EdgeColor','w', ...
  
  %plot( [d(i,1), d(i,2)] ,  wrow , 'Color', colors( d(i,3),:))
end


d = [0   , 1.93  , 5  ,8.5;...
     1.95, 8.22  , 11 ,8.5;...
     8.22, 8.78  , 5  ,8.5;...
     8.78, 14.83 , 12 ,8.5;...
     14.83,15.48 , 5  ,8.5;...
     15.48,18.13 , 11 ,8.5;...
     18.13, 28.70, 15 ,8.5;...
     
     3.7, 6.03, 16 ,8.;...
     11.77,	13.33, 16 ,8.;...
     13.65,	14.10, 16,8.
     ] 
for i=1:size(d,1)

  row = mapping(find(mapping(:,1) == d(i,3)),2);
  row = d(i,4);
  wrow = row + [0 0.5] ;
  dims = [ d(i,1) wrow(1) d(i,2)-d(i,1) wrow(2)-wrow(1)]   

  rectangle('Position', dims, ...
    'FaceColor', colors(d(i,3),:) )
end 

set(gca,'XGrid','on') 
plot([0 30],[1. 1.],':k')
plot([0 30],[4.5 4.5],':k')
plot([0 30],[7. 7.],'-k')
box on
axis([0 30 -0.25 11.])

text_up = 9.28
slabel(1) = text(0.5,text_up,'Walking');%,'FontSize',18)
slabel(2) = text(5,text_up,'Picking Drill');%,'FontSize',18)
slabel(3) = text(8.25,text_up,'Walking');%,'FontSize',18)
slabel(4) = text(12,text_up,'Turning On');%,'FontSize',18)
slabel(5) = text(14.85,text_up,'Walking');%,'FontSize',18)
slabel(6) = text(16.5,text_up,'Reaching');%,'FontSize',18)
slabel(7) = text(24,text_up,'Drilling');%,'FontSize',18)
set( slabel,'Rotation',30,...
'HorizontalAlignment','left');

text_up = 7.75;
tlabel(1) = text(22.12, text_up,'1');%,'FontSize',18)
tlabel(2) = text(23.13, text_up,'2');%,'FontSize',18)
tlabel(3) = text(28.7, text_up,'3 & 4');%,'FontSize',18)
set( tlabel,'Rotation',0,...
'HorizontalAlignment','center');

% basic:
%set(gca,'YTick',[0.25 2.6 5.75, 7.75,8.25, 8.75])
%l = {'Stepping';'Manipulation'; 'Interaction'; 'Score'; 'Unplanned'; 'Stage'}

set(gca,'YTick',[0.25, ...
                 1.75, 2.25, 2.75, 3.25, ...
                 3.75, 5.25, 5.75, ...
                 6.25, 7.75,8.25, 8.75])
l = {'Stepping'; ...
  'Scripted'; 'Reaching' ; 'Grasping'; 'Hand Teleop';  ...
  'Semi Auton.';'Manual Fit'; 'Assessment'; ...
  'System Issue'; 'Score'; 'Recovery'; 'Summary'}

set(gca,'YTickLabel',l)
%xlabel('Time (Minutes)')



if (1==0)
YTickLabel = get(gca,'YTickLabel');
set(gca,'YTickLabel',' ');
hyLabel = get(gca,'YLabel');
set(hyLabel,'Units','data');
yLabelPosition = get(hyLabel,'Position');
x = -0.8;%yLabelPosition(2);
YTick = get(gca,'YTick');
x=repmat(x,length(YTick),1);
fs = get(gca,'fontsize');
hText = text(x, YTick, l,'fontsize',fs);
set(hText,'Rotation',90,...
'HorizontalAlignment','center');
set(gca, 'YTick', []);
end

set(gca, 'Ticklength', [0 0])



